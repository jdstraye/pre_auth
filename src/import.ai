from typing import Tuple
import pandas as pd
from pandas import DataFrame, Series
from sklearn.model_selection import train_test_split

# Explicit type for the DataFrame
df: DataFrame = pd.read_csv(input_path)

# Explicit type for function param and return
def categorize_tier(tier: float | None) -> str:
    if pd.isna(tier):
        return 'Missing'
    tier = float(tier)
    if tier == 0.12:
        return 'B-Tier1 Prime'
    elif 0.045 <= tier <= 0.165:
        return 'Tier1'
    elif 0.24 <= tier <= 0.32:
        return 'Tier2'
    elif 0.33 <= tier <= 0.43:
        return 'Tier3'
    elif 0.44 <= tier <= 0.51:
        return 'Tier4'
    else:
        return 'Other'

# Apply the categorization
df['tier_range'] = df['final_contract_tier'].apply(categorize_tier)

# Train/test split return types
train_df, test_df = train_test_split(  # type: Tuple[DataFrame, DataFrame]
    df_filtered,
    test_size=0.25,
    stratify=df_filtered['stratify_key'],
    random_state=42,
)
